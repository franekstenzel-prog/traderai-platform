{% extends "base.html" %}
{% block title %}TraderAI â€” {{ page_title or "App" }}{% endblock %}

{% block content %}
<div data-app-shell class="app-shell">
  <div class="sidebar-overlay" data-sidebar-overlay></div>
  <aside class="app-shell__nav">
    <div class="card card--inset" style="margin-bottom:12px">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:10px">
        <div>
          <div class="big">App</div>
          <div class="muted small">{{ user['email'] }}</div>
        </div>
        <div class="pill">{{ user_plan_label }}</div>
      </div>
      {% if user_stripe_status and user_plan_label != "Free" %}
        <div class="muted small" style="margin-top:8px">Billing status: <span class="mono">{{ user_stripe_status }}</span></div>
      {% endif %}
    </div>

    <div class="nav-group">
      <a class="nav-item {% if active=='dashboard' %}is-active{% endif %}" href="{{ url_for('dashboard') }}">
        <span class="nav-item__icon"></span> Dashboard
      </a>
      <a class="nav-item {% if active=='analyze' %}is-active{% endif %}" href="{{ url_for('analyze_page') }}">
        <span class="nav-item__icon"></span> Analyze
      </a>
      <a class="nav-item {% if active=='journal' %}is-active{% endif %}" href="{{ url_for('journal') }}">
        <span class="nav-item__icon"></span> Journal
      </a>
      <a class="nav-item {% if active=='performance' %}is-active{% endif %}" href="{{ url_for('performance') }}">
        <span class="nav-item__icon"></span> Performance
      </a>
      <a class="nav-item {% if active=='learn' %}is-active{% endif %}" href="{{ url_for('learn') }}">
        <span class="nav-item__icon"></span> Learn
      </a>
      <a class="nav-item {% if active=='calculator' %}is-active{% endif %}" href="{{ url_for('calculator') }}">
        <span class="nav-item__icon"></span> Calculator
      </a>
      <a class="nav-item {% if active=='billing' %}is-active{% endif %}" href="{{ url_for('billing') }}">
        <span class="nav-item__icon"></span> Billing
      </a>
      <a class="nav-item {% if active=='account' %}is-active{% endif %}" href="{{ url_for('account') }}">
        <span class="nav-item__icon"></span> Account
      </a>
    </div>

    <div class="nav-group" style="margin-top:18px">
      <a class="nav-item" href="{{ url_for('logout') }}"><span class="nav-item__icon"></span> Log out</a>
    </div>

    <div class="muted small" style="margin-top:14px;padding:0 10px">
      <div>Version: <span class="mono">{{ APP_VERSION }}</span></div>
      {% if remaining is not none %}
        <div style="margin-top:6px">Analyses remaining (free): <span class="mono">{{ remaining }}</span></div>
      {% endif %}
    </div>
  </aside>

  <section class="app-shell__main">
    <div class="app-top">
      <div class="app-title">{{ page_title or "Dashboard" }}</div>
      {% block app_top_actions %}{% endblock %}
    </div>

    {% block app_content %}{% endblock %}
  </section>
</div>
{% endblock %}
