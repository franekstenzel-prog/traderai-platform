{% extends "layout_app.html" %}
{% set page_title = "Performance" %}
{% set active = "performance" %}

{% block app_content %}
  <div class="grid3">
    <div class="card">
      <div class="muted">Trades</div>
      <div class="big">{{ stats.total_trades }}</div>
      <div class="muted small">Wins: {{ stats.wins }} • Losses: {{ stats.losses }} • Breakeven: {{ stats.be }} </div>
    </div>
    <div class="card">
      <div class="muted">Win rate</div>
      <div class="big">{{ "%.1f"|format(stats.win_rate) }}%</div>
      <div class="muted small">Avg win (R): {{ "%.2f"|format(stats.avg_win_r) }} • Avg loss (R): {{ "%.2f"|format(stats.avg_loss_r) }}</div>
    </div>
    <div class="card">
      <div class="muted">Net PnL</div>
      <div class="big">{{ "%.2f"|format(stats.net_pnl) }}</div>
      <div class="muted small">Profit factor: {{ "%.2f"|format(stats.profit_factor) }} • Expectancy (R): {{ "%.2f"|format(stats.expectancy_r) }}</div>
    </div>
  </div>

  <div class="grid2" style="margin-top:16px">
    <div class="card">
      <div class="card__title">Monthly summary</div>
      {% if monthly and monthly|length %}
        <div class="table-wrap">
          <table class="table">
            <thead>
              <tr><th>Month</th><th class="right">Trades</th><th class="right">Net PnL</th><th class="right">Win rate</th></tr>
            </thead>
            <tbody>
              {% for m in monthly %}
                <tr>
                  <td class="mono">{{ m.month }}</td>
                  <td class="right">{{ m.trades }}</td>
                  <td class="right mono">{{ "%.2f"|format(m.net_pnl) }}</td>
                  <td class="right">{{ "%.1f"|format(m.win_rate) }}%</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      {% else %}
        <div class="muted">No data yet. Add trades in the Journal.</div>
      {% endif %}
    </div>

    <div class="card">
      <div class="card__title">Streaks</div>
      <div class="grid2">
        <div class="card card--inset">
          <div class="muted">Best win streak</div>
          <div class="big">{{ stats.best_win_streak }}</div>
        </div>
        <div class="card card--inset">
          <div class="muted">Worst loss streak</div>
          <div class="big">{{ stats.worst_loss_streak }}</div>
        </div>
      </div>
      <div class="muted" style="margin-top:12px">
        Tip: Use R-multiple. It normalizes results across position sizes.
      </div>
    </div>
  </div>
{% endblock %}
